<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">

    <title>Llama Watch</title>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    <style>
    @import url(//fonts.googleapis.com/css?family=Roboto:400,300,500,700);
    @import url(//fonts.googleapis.com/css?family=Inconsolata:400,700);

    body {
      background-color: #f5f5f5;
      font-family: 'Roboto', Helvetica, Arial, sans-serif;
      line-height: 1.428571429;
      color: #262626;
      margin: 0;
      padding: 0;
      font-size: 16px;
      overflow-y: scroll;
    }

    #coin { text-align: center; background-color: #fff; width: 100%; box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px; margin-bottom: 30px; }
    #coin a { display: block; }
    #coin a:hover { text-decoration: none; }
    #coin img { margin: 30px; max-width: 100%; max-height: 125px }
    #coin .name { display: block; width: 100%; background-color: #53f442; color: #fff; font-size: 18px; font-weight: 700; padding: 6px 12px; text-align: center; }
    #coin ul.stats { padding: 0; margin: 0; text-align: left; font-family: 'Inconsolata', monospace; }
    #coin ul.stats strong { font-weight: 700; }
    #coin ul.stats li { list-style: none; border-bottom: 1px solid #ececec; padding: 7px 15px; font-size: 15px; color: #333; }
    </style>
</head>
<body>

<div class="container"><div class="row">

    <div class="col-xs-12">
        <br/>

        <br/>
    </div>

    <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://trtl.llama.horse/">
            <span class="name">Turtle coin (TRTL)</span>
            <ul class="stats">
                <li><strong><span id="trtl_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="trtl_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="trtl_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="trtl_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="trtl_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="trtl_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="trtl_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="trtl_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="trtl_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="trtl_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="trtl_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="trtl_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="trtl_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="trtl_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

   <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://sumo.llama.horse/">
            <span class="name">Sumokoin (SUMO)</span>
            <ul class="stats">
                <li><strong><span id="sumo_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="sumo_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="sumo_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="sumo_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="sumo_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="sumo_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="sumo_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="sumo_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="sumo_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="sumo_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="sumo_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="sumo_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="sumo_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="sumo_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

    <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://amit.llama.horse/">
            <span class="name">Amity Coin (AMIT)</span>
            <ul class="stats">
                <li><strong><span id="amit_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="amit_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="amit_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="amit_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="amit_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="amit_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="amit_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="amit_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="amit_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="amit_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="amit_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="amit_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="amit_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="amit_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

    <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://ncp.llama.horse/">
            <span class="name">Newton Coin Project (NCP)</span>
            <ul class="stats">
                <li><strong><span id="ncp_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="ncp_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="ncp_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="ncp_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="ncp_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="ncp_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="ncp_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="ncp_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="ncp_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="ncp_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="ncp_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="ncp_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="ncp_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="ncp_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

    <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://xtri.llama.horse/">
            <span class="name">Triton (XTRI)</span>
            <ul class="stats">
                <li><strong><span id="xtri_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="xtri_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="xtri_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="xtri_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="xtri_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="xtri_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="xtri_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="xtri_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="xtri_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="xtri_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="xtri_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="xtri_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="xtri_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="xtri_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

    <div class="col-md-4 col-sm-6"><div id="coin">
        <a href="http://etn.llama.horse/">
            <span class="name">Electroneum (ETN)</span>
            <ul class="stats">
                <li><strong><span id="etn_poolMiners">...</span></strong> active miners</span></li>
                <li><strong><span id="etn_poolHashrate">...</span></strong> pool hashrate</span></li>
                <li><strong><span id="etn_networkHashrate">...</span></strong> network hashrate</span></li>
                <li><strong><span id="etn_hashPower">...</span></strong> of network hashrate</span></li>
                <li><strong><span id="etn_blocksFound">...</span></strong> blocks found</span></li>
                <li><strong><span id="etn_algorithm">...</span></strong> algorithm</span></li>
		<li><strong><span id="etn_poolHeight">...</span></strong> height</span></li>
		<li><strong><span id="etn_compHeight">...</span></strong> comp height</span></li>
		<li><strong><span id="etn_daemonStatus">...</span></strong> daemon status</span></li>
		<li><strong><span id="etn_daemonLastCheck">...</span></strong> daemon last check</span></li>
		<li><strong><span id="etn_daemonLastFail">...</span></strong> deamon last fail</span></li>
		<li><strong><span id="etn_walletStatus">...</span></strong> wallet status</span></li>
		<li><strong><span id="etn_walletLastCheck">...</span></strong> wallet last check</span></li>
		<li><strong><span id="etn_walletLastFail">...</span></strong> wallet last fail</span></li>
            </ul>
        </a>
    </div></div>

</div></div>
<br/>

<script>
/**
 * Pool statistics
 **/

// Get stats from pool API
function getPoolStats(poolID, poolURL) {
    var apiURL = poolURL + '/stats';
    $.get(apiURL, function(data){
        if (!data) return ;

        var poolHashrate = 'N/A';
        var poolMiners   = 'N/A';
        var poolWorkers  = 'N/A';
        if (data.pool) {
            poolHashrate = getReadableHashRate(data.pool.hashrate);
            poolMiners   = data.pool.miners || 0;
            poolWorkers  = data.pool.workers || 0;
        }

        var networkHashrate = 'N/A';
        var networkDiff     = 'N/A';
        if (data.network) {
            networkHashrate = getReadableHashRate(data.network.difficulty / data.config.coinDifficultyTarget);
            networkDiff     = data.network.difficulty;
        }

		var poolHeight = 'N/A';
		if (data.network) {
			poolHeight = data.network.height;
		}

        var hashPower = 'N/A';
        if (data.pool && data.network) {
            hashPower = data.pool.hashrate / (data.network.difficulty / data.config.coinDifficultyTarget) * 100;
            hashPower = hashPower.toFixed(2) + '%';
        }

        var blocksFound = data.pool.totalBlocks.toString();

//		  var daemonStatus = data.daemon.lastStatus;
//      var walletStatus = data.wallet.lastStatus;

        var cnAlgorithm = data.config.cnAlgorithm || "cryptonight";
        var cnVariant = data.config.cnVariant || 0;

        if (cnAlgorithm == "cryptonight_light") {
            if (cnVariant === 1) {
                algorithm = 'Cryptonight Light v7';
            } else if (cnVariant === 2) {
                algorithm = 'Cryptonight Light';
            } else {
                algorithm = 'Cryptonight Light';
            }
        }
        else if (cnAlgorithm == "cryptonight_heavy") {
            algorithm = 'Cryptonight Heavy';
        }
        else {
            if (cnVariant === 1) {
                algorithm = 'Cryptonight v7';
            } else if (cnVariant === 3) {
                algorithm = 'Cryptonight v7';
            } else {
                algorithm = 'Cryptonight';
            }
        }

        updateText(poolID + '_poolHashrate', poolHashrate);
        updateText(poolID + '_poolMiners', poolMiners);
        updateText(poolID + '_networkHashrate', networkHashrate);
        updateText(poolID + '_hashPower', hashPower);
        updateText(poolID + '_blocksFound', blocksFound);
        updateText(poolID + '_algorithm', algorithm);
        updateText(poolID + '_poolHeight', poolHeight);
		    uptdateText(poolID + '_daemonStatus', daemonStatus);
    });
}

// Set CheckTime
function getCheckTime(timestamp) {
    return timestamp ? $.timeago(new Date(timestamp * 1000).toISOString()) : null;
}

// Get stats from comp pool API
function getCompPoolStats(compID, compURL) {
    var compApiURL = compURL + '/stats';
    $.get(compApiURL, function(data){
        if (!data) return ;

		var compHeight = 'N/A';
		if (data.network) {
			compHeight = data.network.height;
		}

		updateText(compID + '_compHeight', compHeight);
    });
}

// Update pools
function updatePools() {
    getPoolStats('trtl', 'http://pool.llama.horse:8118');
    getPoolStats('sumo', 'http://pool.llama.horse:19732');
    getPoolStats('amit', 'http://pool.llama.horse:8121');
    getPoolStats('ncp', 'http://pool.llama.horse:21238');
    getPoolStats('xtri', 'http://pool.llama.horse:8117');
    getPoolStats('etn', 'http://pool.llama.horse:8120');
}

// Update comp pools
function updateCompPools() {
    getCompPoolStats('trtl', 'http://turtlepool.space:8117');
    getCompPoolStats('sumo', 'http://pool.llama.horse:19732');
    getCompPoolStats('amit', 'http://amit.youpool.io:8124');
    getCompPoolStats('ncp', 'http://pool.llama.horse:21238');
    getCompPoolStats('xtri', 'http://pool.llama.horse:8117');
    getCompPoolStats('etn', 'http://pool.llama.horse:8120');
}

// Initialize
$(function() {
    setInterval(updatePools, (30*1000));
    updatePools();
    updateCompPools();
});

/**
 * Strings
 **/

// Update Text content
function updateText(elementId, text){
    var el = document.getElementById(elementId);
    if (el && el.textContent !== text){
        el.textContent = text;
    }
    return el;
}

// Get readable hashrate
function getReadableHashRate(hashrate){
    var i = 0;
    var byteUnits = [' H', ' KH', ' MH', ' GH', ' TH', ' PH' ];
    while (hashrate > 1000){
        hashrate = hashrate / 1000;
        i++;
    }
    return hashrate.toFixed(2) + byteUnits[i] + '/s';
}
</script>

</body>
</html>
